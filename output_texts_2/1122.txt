Sophos Home protects every Mac and PC in your home 
Open source web programming language PHP narrowly avoided a potentially dangerous supply chain attack over the weekend.
Technically, in fact, you could say that the ‚Äúattack‚Äù was successful, given that imposters were apparently able to make to make the same source code change on two separate occasions:
Fortunately, however, the changes were noticed and reverted within hours, so they didn‚Äôt make it into any official PHP release.
In theory, anyone who downloaded the very latest ‚Äústill in development‚Äù version of PHP on Sunday 2021-03-28, compiled it, and installed it on a real-life, internet facing web server could have been at risk‚Ä¶
‚Ä¶but we think the total number of people who did that is probably zero, with the possible exception of the crooks themselves proving a point.
The modifications above introduce a nasty remote code execution backdoor to any server that uses PHP‚Äôs  Zlib compression for content it sends out. 
(These days, many, if not most, web pages are compressed before they‚Äôre transmitted, unless they are files such as images or download archives that are already compressed and so won‚Äôt compress much more, if at all.)
The backdoor is triggered when PHP output compression starts, and it:
This backdoors turns PHP itself into what‚Äôs known as a webshell ‚Äì an implanted malicious file on the server that can not only be triggered by an external attacker, but also instructed to run any system command the attacker wants at any time.
In other words, a remote shell of this sort doesn‚Äôt just let cybercriminals run some commands, it lets them run any commands, and therefore to adapt and alter their attack as they go along.
The unauthorised code changes were tagged with the names of Rasmus Lerdorf (creator of PHP) and Nikita Popov (a major PHP contributor).
PHP development is managed using the well-known Git source code control system, on a server operated by the PHP team itself.
According to Popov:
We don‚Äôt yet know how exactly this happened, but everything points towards a compromise of the git.php.net server (rather than a compromise of an individual git account).
Until now, the team has used Microsoft‚Äôs cloud-based GitHub service as a mirror (secondary copy) of its codebase, but says that ‚Äúthe repositories on GitHub [‚Ä¶] will become canonical,‚Äù which is the jargon term for the primary copy, and says ‚Äúwe have decided that maintaining our own git infrastructure is an unnecessary security risk, and that we will discontinue the git.php.net server.‚Äù
Popov also said:
We‚Äôre reviewing the repositories for any corruption beyond the two referenced commits. Please contact security@php.net if you notice anything.
The good news, as we mentioned above, is that this backdoor didn‚Äôt make it into any official PHP releases, so it‚Äôs highly unlikely that this Trojan Horse code made it into any real-world servers.
In particular, if you didn‚Äôt download PHP and rebuild it from source code over the past weekend, you‚Äôre unlikely to have come anywhere near this.
If you‚Äôre worried, check the file etc/zlib/zlib.c in your PHP source code tree for signs of the added lines shown above.
In particular, the text string zend_eval should not appear anywhere in the /etc/zlib/* files, so if you run this command from the top of your PHP tree, you shouldn‚Äôt see any matches:
If the above backdoor code has somehow made it into your PHP tree, you would see something like this instead‚Ä¶
In the unlikely event that your code includes the backdoor, you need to refresh your PHP source from the new repository as well as looking for any other unexplained modifications in your code, or unexpected commands in your logs..
Follow @NakedSecurity on Twitter for the latest computer security news.
Follow @NakedSecurity on Instagram for exclusive pics, gifs, vids and LOLs!
‚Äú‚Ä¶anyone who downloaded the very latest ‚Äústill in development‚Äù version of PHP‚Ä¶‚Äù
I can‚Äôt think of any reason to do this, other than pure excitement of exploring development builds üôÇ And this should only be performed on internal only/non public facing development servers.  Good to see that the PHP team are reviewing & improving.  Oh and thanks for detailing the steps to make our own checks
You are most welcome. Thanks for your kind words ‚Äì glad you found the tips useful.
Comment * 
Name 
Email 
Website 
 



Œî